import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,d as n,o as p}from"./app-UKhqlS50.js";const e={};function l(t,s){return p(),i("div",null,s[0]||(s[0]=[n(`<h1 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment"><span>Deployment</span></a></h1><p>Deployment 可以控制 Pod，使 Pod 拥有多副本，自愈，扩缩容等能力。</p><h2 id="创建-deployment-及简单使用" tabindex="-1"><a class="header-anchor" href="#创建-deployment-及简单使用"><span>创建 Deployment 及简单使用</span></a></h2><p>命令行方式：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">使用指定的镜像进行部署，并创建共计三份实例副本</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">create</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--image=nginx</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--replicas=3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果任意的副本 Pod 被删除或者 Pod 所在的机器宕机，则 Deployment 将会填补上缺失的副本个数，维持在 3 个。</p></div><p>删除 Deployment：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">delete</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">demo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>配置文件方式：</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">apiVersion</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">apps/v1</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">kind</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">Deployment</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">metadata</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">demo</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">namespace</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">example</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">spec</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">selector</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">matchLabels</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">app</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">nginx</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">replicas</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">2</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">tells</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">deployment</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">to</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">run</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">2</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">pods</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">matching</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">the</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">template</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">template</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">metadata</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">labels</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">app</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">nginx</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">spec</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">containers</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">nginx</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">nginx:1.14.2</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">containerPort</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">80</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看 Deployment 的详情：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">describe</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看 Deployment 创建的 Pods：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">app</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">后是</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">spec.template.metadata.labels.app</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pods</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-l</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">app=nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果修改了配置文件的内容，再次调用 <code>kubectl apply -f config.yaml</code>，将会将对应的 Deployment 更新为最新的配置文件制定的内容，并且是滚动更新。</p></div><p>扩缩容：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">scale</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment/demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--replicas=5</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>版本回退：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">查看历史版本</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rollout</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">history</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment/demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">查看某个历史版本的详情</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rollout</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">history</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment/demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--revision=1</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#回滚(回到上次)</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rollout</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">undo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment/demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#回滚(回到指定版本)</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rollout</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">undo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">deployment/demo</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">example</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--to-revision=2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19)]))}const k=a(e,[["render",l]]),d=JSON.parse('{"path":"/kubernetes/docs/deployment.html","title":"Deployment","lang":"zh-CN","frontmatter":{"description":"Deployment Deployment 可以控制 Pod，使 Pod 拥有多副本，自愈，扩缩容等能力。 创建 Deployment 及简单使用 命令行方式： 提示 如果任意的副本 Pod 被删除或者 Pod 所在的机器宕机，则 Deployment 将会填补上缺失的副本个数，维持在 3 个。 删除 Deployment： 配置文件方式： 查看 De...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Deployment\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-13T01:18:18.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://ppg007.github.io/kubernetes/docs/deployment.html"}],["meta",{"property":"og:site_name","content":"PPG007 的文档"}],["meta",{"property":"og:title","content":"Deployment"}],["meta",{"property":"og:description","content":"Deployment Deployment 可以控制 Pod，使 Pod 拥有多副本，自愈，扩缩容等能力。 创建 Deployment 及简单使用 命令行方式： 提示 如果任意的副本 Pod 被删除或者 Pod 所在的机器宕机，则 Deployment 将会填补上缺失的副本个数，维持在 3 个。 删除 Deployment： 配置文件方式： 查看 De..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-13T01:18:18.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-13T01:18:18.000Z"}]]},"git":{"createdTime":1648908246000,"updatedTime":1747099098000,"contributors":[{"name":"PPG007","username":"PPG007","email":"1658272229@qq.com","commits":1,"url":"https://github.com/PPG007"},{"name":"Koston Zhuang","username":"","email":"koston.zhuang@maiscrm.com","commits":1}]},"readingTime":{"minutes":1.07,"words":321},"filePathRelative":"kubernetes/docs/deployment.md","excerpt":"\\n<p>Deployment 可以控制 Pod，使 Pod 拥有多副本，自愈，扩缩容等能力。</p>","autoDesc":true}');export{k as comp,d as data};
