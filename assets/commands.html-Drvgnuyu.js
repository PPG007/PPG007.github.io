import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as n,o as p}from"./app-UKhqlS50.js";const l={};function e(h,s){return p(),a("div",null,s[0]||(s[0]=[n(`<h1 id="openssl-命令" tabindex="-1"><a class="header-anchor" href="#openssl-命令"><span>OpenSSL 命令</span></a></h1><h2 id="genrsa" tabindex="-1"><a class="header-anchor" href="#genrsa"><span>genrsa</span></a></h2><p>genrsa 用于生成 RSA 私钥，不会生成公钥，因为公钥提取自私钥，如果要查看公钥或者生成公钥可以使用 <code>openssl rsa</code> 命令。</p><p><code>openssl genrsa [-out filename] [-passout arg] [-des] [-des3] [-idea] [numbits]</code>：</p><ul><li><p><code>-out filename</code>：将私钥输出到指定的文件，如果不指定此参数会输出到标准输出。</p></li><li><p><code>passout arg</code>：加密私钥文件时传递密码的格式，如果要加密私钥文件时没有指定此参数则提示输入密码。</p><p>密码格式：</p><ul><li>格式一：<code>pass:password</code>，password 表示传递的明文密码。</li><li>格式二：<code>env:var</code>，从环境变量 var 获取密码。</li><li>格式三：<code>file:filename</code>，filename 文件中的第一行作为密码，如果同时使用此格式传递给 passin 和 passout 选项，则第一行是 passin，第二行是 passout。</li><li>格式三：<code>stdin</code>：从标准输入中获取要传递的密码。</li></ul></li><li><p><code>numbits</code>：指定要生成的私钥的长度，默认为 1024，该项必须是命令行的最后一项参数。</p></li><li><p><code>-des|-des3|-idea</code>：指定加密私钥文件用的算法，这样每次使用私钥文件都将输入密码。</p></li></ul><p>使用下面的命令生成一个不加密的私钥并输出到文件 private.key：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">genrsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>生成一个加密的私钥文件并输出到 private-secret.key 文件中：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">genrsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passout</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="rsa、pkey" tabindex="-1"><a class="header-anchor" href="#rsa、pkey"><span>rsa、pkey</span></a></h2><p>openssl rsa 和 openssl pkey 分别是 RSA 密钥的处理工具和通用非对称密钥处理工具，它们用法基本一致。</p><p><code>openssl rsa [-in filename] [-passin arg] [-passout arg] [-out filename] [-des|-des3|-idea] [-text] [-noout] [-pubin] [-pubout] [-check]</code></p><ul><li><code>-in filename</code> ：指定密钥输入文件。默认读取的是私钥，若指定 -pubin 选项将表示读取公钥。将从该文件读取密钥，不指定时将从stdin 读取。</li><li><code>-out filename</code>：指定密钥输出文件。默认输出私钥，若指定 -pubin 或 -pubout 选项都将输出公钥。不指定将输出到 stdout。</li><li><code>-pubin</code>：指定该选项时，将显式表明从 -in filename 的 filename 中读取公钥，所以 filename 必须为公钥文件。不指定该选项时，默认是从filename中读取私钥。</li><li><code>-pubout</code>：指定该选项时，将显示表明从 -in filename 的 filename 中提取公钥并输出，所以 filename 文件必须是私钥文件。不指定该选项时，默认输出私钥。当设置了 -pubin 时，默认也设置了 -pubout。</li><li><code>-noout</code> ：控制不输出任何密钥信息。</li><li><code>-text</code> ：转换输入和输出的密钥文件格式为纯文本格式。</li><li><code>-check</code> ：检查 RSA 密钥是否完整未被修改过，只能检测私钥，因为公钥来源于私钥。因此选项 <code>-in filename</code> 的 filename 文件只能是私钥文件。</li><li><code>-des|-des3|-idea</code>：加密输出文件，使得每次读取输出文件时都需要提供密码。</li><li><code>-passin arg</code> ：传递解密密钥文件的密码。密码格式见 openssl 密码格式。</li><li><code>-passout arg</code>：指定加密输出文件的密码。</li></ul><p><code>openssl pkey [-passin arg] [-passout arg] [-in filename] [-out filename] [-cipher] [-text] [-noout] [-pubin] [-pubout]</code></p><ul><li><code>-cipher</code>：等价于 openssl rsa 的 <code>-des|-des3|-idea</code>，例如 <code>-cipher des3</code>。</li></ul><p>将上面生成的未加密的私钥对应的公钥提取到 public.key 文件中：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pubout</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">public.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将上面生成的加密的私钥的公钥提取到 public-secret.key 文件中：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:test</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pubout</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">public-secret.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>解除加密的公私钥文件：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:test</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-withoutsecr</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">et.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>直接读取输出即可。</p><p>检查私钥文件是否被修改过：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-check</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="使用成对的公私钥加密解密文件" tabindex="-1"><a class="header-anchor" href="#使用成对的公私钥加密解密文件"><span>使用成对的公私钥加密解密文件</span></a></h2><p>由于 Go 的官方库中 RSA 只支持公钥加密私钥解密，所以这里我们借助一个开源库：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">go</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">github.com/farmerx/gorsa</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后使用下面的代码进行公私钥加密解密：</p><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-go"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">package</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">import</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;errors&quot;</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;fmt&quot;</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;github.com/farmerx/gorsa&quot;</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;io/ioutil&quot;</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;os&quot;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">type</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">Type</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">const</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E5C07B;--shiki-light:#0070C1;">public</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">Type</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;public&quot;</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E5C07B;--shiki-light:#0070C1;">private</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">Type</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;private&quot;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">var</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">privateKey</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">publicKey</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">loadKeyFromFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">fileName</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">([]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">error</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">ioutil</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">ReadFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fileName</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">init</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">privateKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">loadKeyFromFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;private.key&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">publicKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">loadKeyFromFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;public.key&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">SetPrivateKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">privateKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">SetPublicKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">publicKey</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">main</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">stringDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">ioutil</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">ReadFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;source.yaml&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">bytesDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">ioutil</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">ReadFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;source.mkv&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">panic</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">pubEncryptPriDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">stringDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;string&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">priEncryptPubDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">stringDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;string&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">pubEncryptPriDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">bytesDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;bytes&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">priEncryptPubDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">bytesDate</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;bytes&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">encrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">source</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">keyType</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">Type</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">([]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">error</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">keyType</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">==</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">public</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">PubKeyENCTYPT</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">source</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">else</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">keyType</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">==</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">private</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">PriKeyENCTYPT</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">source</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">else</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">errors</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">New</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;not</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">supported</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">key</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">type&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">decrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">data</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">keyType</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#267F99;">Type</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">([]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">error</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">keyType</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">==</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">public</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">PubKeyDECRYPT</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">data</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">else</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">keyType</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">==</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">private</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">gorsa</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">RSA</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">PriKeyDECRYPT</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">data</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">else</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">errors</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">New</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;not</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">supported</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">key</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">type&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">pubEncryptPriDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">source</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">filePrefix</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">os</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Create</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Sprintf</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span style="--shiki-dark:#D19A66;--shiki-light:#001080;">%s</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">-publicEncrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">filePrefix</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">defer</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Close</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;start</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pubEncrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">encrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">source</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">public</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;pubEncrypt</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">over&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">_</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Write</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;start</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">priDecrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">decrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">private</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;priDecrypt</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">over&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">os</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Create</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Sprintf</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span style="--shiki-dark:#D19A66;--shiki-light:#001080;">%s</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">-privateDecrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">filePrefix</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">defer</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Close</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">_</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Write</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">func</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">priEncryptPubDecryptTest</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">source</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[]</span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">byte</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#001080;--shiki-light-font-style:inherit;">filePrefix</span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#267F99;">string</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">os</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Create</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Sprintf</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span style="--shiki-dark:#D19A66;--shiki-light:#001080;">%s</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">-privateEncrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">filePrefix</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">defer</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Close</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;start</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">priEncrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">encrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">source</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">private</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;priEncrypt</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">over&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">_</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">file</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Write</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;start</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pubDecrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">decrypt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">encrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">public</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Println</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;pubDecrypt</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">over&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">:=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">os</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Create</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fmt</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Sprintf</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span style="--shiki-dark:#D19A66;--shiki-light:#001080;">%s</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">-publicDecrypt&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">filePrefix</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">))</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">defer</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Close</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">()</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">_</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">,</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#E5C07B;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decryptedFile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">.</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">Write</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">(</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">decrypted</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">if</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">err</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#000000;">!=</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">nil</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="tab">	</span><span class="tab">	</span><span style="--shiki-dark:#C678DD;--shiki-light:#AF00DB;">return</span></span>
<span class="line"><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面这段代码分别对两个文件进行了加解密操作，分别使用公钥加密私钥解密以及私钥加密公钥解密。</p><h2 id="openssl-dgst-生成和验证数字签名" tabindex="-1"><a class="header-anchor" href="#openssl-dgst-生成和验证数字签名"><span>openssl dgst 生成和验证数字签名</span></a></h2><p>数字签名的过程是计算出数字摘要，然后使用私钥对数字摘要进行签名，而摘要是使用 md5、sha512 等算法计算得出的。</p><p><code>openssl dgst [-md5|-sha1|...] [-hex | -binary] [-out filename] [-sign filename] [-passin arg] [-verify filename] [-prverify filename] [-signature filename] [file...]</code>：</p><ul><li><code>file...</code>：指定待签名的文件。</li><li><code>-hex</code>：以 hex 格式输出数字摘要。如果不以 <code>-hex</code> 显示，签名或验证签名时很可能乱码。</li><li><code>-binary</code>：以二进制格式输出数字摘要，或以二进制格式进行数字签名。这是默认格式。</li><li><code>-out filename</code>：指定输出文件，若不指定则输出到标准输出。</li><li><code>-sign filename</code>：使用 filename 中的私钥对 file 数字签名。签名时绝对不能加 <code>-hex</code> 等格式的选项，否则验证签名必失败。</li><li><code>-signature filename</code>：指定待验证的签名文件。</li><li><code>-verify filename</code>：使用 filename 中的公钥验证签名。</li><li><code>-prverify filename</code>：使用 filename 中的私钥验证签名。</li><li><code>-passin arg</code>：传递解密密码。若验证签名时实用的公钥或私钥文件是被加密过的，则需要传递密码来解密。</li></ul><p>支持 md4、md5、ripemd160、sha、sha1、sha224、sha256、sha384、sha512、whirlpool 这几种单向加密算法，即哈希算法。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p><code>openssl dgst -md5</code> 等价于 <code>openssl md5</code>。</p></div><p>对 source.yaml 生成 md5 摘要信息及 sha512 摘要信息：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-md5</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha512</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用一个加密过的私钥对 source.yaml 文件签名：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">加入</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">-hex</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">参数防止输出乱码</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sign</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:123456</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-hex</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>验证签名，注意要将签名输出到文件且不能使用 -hex 参数：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">先生成新签名</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sign</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:123456</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">私钥验证</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-prverify</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:123456</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-signature</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">公钥验证</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-verify</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">public-secret.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-passin</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:123456</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-signature</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst.out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="openssl-rsautl-和-pkeyutl" tabindex="-1"><a class="header-anchor" href="#openssl-rsautl-和-pkeyutl"><span>openssl rsautl 和 pkeyutl</span></a></h2><p>rsautl 是 rsa 的工具，相当于 rsa、dgst 的部分功能集合，可用于生成数字签名、验证数字签名、加密和解密文件。</p><p>pkeyutl 是非对称加密的通用工具。</p><p><code>openssl rsautl [-in file] [-out file] [-inkey file] [-pubin] [-certin] [-passin arg] [-sign] [-verify] [-encrypt] [-decrypt] [-hexdump]</code></p><p><code>openssl pkeyutl [-in file] [-out file] [-sigfile file] [-inkey file] [-passin arg] [-pubin] [-certin] [-sign] [-verify] [-encrypt] [-decrypt] [-hexdump]</code></p><ul><li><code>-in file</code>：指定输入文件。</li><li><code>-out file</code>：指定输出文件。</li><li><code>-inkey file</code>：指定密钥输入文件，默认是私钥文件，指定了 -pubin 则表示为公钥文件，使用 -certin 则表示为包含公钥的证书文件。</li><li><code>-pubin</code>：指定 -inkey file 的 file 是公钥文件。</li><li><code>-certin</code>：使用该选项时，表示 -inkey file 的 file 是包含公钥的证书文件。</li><li><code>-passin arg</code>：传递解密密码。若验证签名时实用的公钥或私钥文件是被加密过的，则需要传递密码来解密。</li><li><code>-sign</code>：签名并输出签名结果，注意，该选项需要提供RSA私钥文件。</li><li><code>-verify</code>：使用验证签名文件。</li><li><code>-encrypt</code>：使用公钥加密文件。</li><li><code>-decrypt</code>：使用私钥解密文件。</li><li><code>-hexdump</code>：以 hex 方式输出。</li><li><code>sigfile file</code>：待验证的签名文件。</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>rsautl 和 pkeyutl 的缺陷在于默认只能对短小的文件进行操作。</p></div><p>公钥加密、私钥解密：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">加密</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsautl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-encrypt</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-inkey</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">public.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pubin</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.yaml</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsautl.yaml</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">解密</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsautl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--decrypt</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-inkey</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">private.key</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsautl.yaml</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsautldec.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="openssl-enc" tabindex="-1"><a class="header-anchor" href="#openssl-enc"><span>openssl enc</span></a></h2><p>openssl enc 是对称加密工具。</p><p><code>openssl enc -ciphername [-in filename] [-out filename] [-pass arg] [-e] [-d] [-a/-base64] [-k password] [-S salt] [-salt] [-md] [-p/-P]</code></p><ul><li><code>-ciphername</code>：指定对称加密算法(如 des3)，可独立于 enc 直接使用，如 openssl des3 或 openssl enc -des3。推荐在 enc 后使用，这样不依赖于硬件。</li><li><code>-in filename</code>：输入文件，不指定时默认是 stdin。</li><li><code>-out filename</code>：输出文件，不指定时默认是 stdout。</li><li><code>-e</code>：对输入文件加密操作，不指定时默认就是该选项。</li><li><code>-d</code>：对输入文件解密操作，只有显示指定该选项才是解密。</li><li><code>-pass</code>：传递加、解密时的明文密码。若验证签名时实用的公钥或私钥文件是被加密过的，则需要传递密码来解密。</li><li><code>-k</code>：已被 -pass 替代，现在还保留是为了兼容老版本的 openssl。</li><li><code>-base64</code>：在加密后和解密前进行 base64 编码或解码，不指定时默认是二进制。</li><li><code>-a</code>：等价于 -base64。</li><li><code>-salt</code>：单向加密时使用 salt 复杂化单向加密的结果，此为默认选项，且使用随机 salt 值。</li><li><code>-S salt</code>：不使用随机 salt 值，而是自定义 salt 值，但只能是 16 进制范围内字符的组合，即 0-9a-fA-F 的任意一个或多个组合。</li><li><code>-p</code>：打印加解密时 salt 值、key 值和 IV 初始化向量值（也是复杂化加密的一种方式），解密时还输出解密结果，见后文示例。</li><li><code>-P</code>：和 -p 选项作用相同，但是打印时直接退出工具，不进行加密或解密操作。</li><li><code>-md</code>：指定单向加密算法，默认 md5。该算法是拿来加密 key 部分的，见后文分析。</li></ul><p>进行对称加解密时，加密和解密的密码是一致的，但是如果使用明文密码非常不安全，需要增加密码的复杂度。最简单的方法就是使用哈希函数计算出明文密码的哈希值，将这个哈希值作为对称密钥。如果还想更安全可以在加密完成后再进行 base64 等编码。</p><div class="hint-container tip"><p class="hint-container-title">对称加密机制</p><p>根据指定的哈希算法，对输入的明文密码进行单向加密，得到固定长度的加密密钥，即对称密钥，，再根据指定的对称加密算法进行加密，最后对加密的文件进行编码。</p></div><div class="hint-container tip"><p class="hint-container-title">对称解密机制</p><p>先解码文件，然后根据同样的哈希算法计算密钥，然后使用对应的对称算法进行解密。</p></div><p>对一个视频文件进行加密解密：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">加密</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enc</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-aes256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">source.mkv</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-e</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pass</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:123456</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-a</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-md</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enc.out</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">解密</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enc</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-aes256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enc.out</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-out</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enc.mkv</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-d</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-md</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pass</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">pass:zzl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="openssl-dhparam" tabindex="-1"><a class="header-anchor" href="#openssl-dhparam"><span>openssl dhparam</span></a></h2><p>此命令用于生成和管理 dh 文件，dh 是密钥交换协议，可以保证通信双方安全地交换密钥。<em>不是加密算法</em>。</p><p><code>openssl dhparam [-in filename] [-out filename] [-dsaparam] [-noout] [-text] [-rand file(s)] [numbits]</code></p><ul><li><code>-in filename</code>：从 filename 文件中读取密钥交换协议参数。</li><li><code>-out filename</code>：输出密钥交换协议参数到 filename 文件。</li><li><code>-dsaparam</code>：指定此选项将使用 dsa 交换协议替代 dh 交换协议。虽然生成速度更快，但更不安全。</li><li><code>-noout</code>：禁止输出任何信息。</li><li><code>-text</code>：以文本格式输出 dh 协议。</li><li><code>-rand</code>：指定随机数种子文件。</li><li><code>numbits</code>：指定生成的长度。</li></ul><p>DH 密钥按协商过程：</p><ul><li>双方协商一个较大的质数并共享，这个质数是种子数。</li><li>双方都协商好一个加密生成器，一般是 AES。</li><li>双方各自提出一个质数，这次双方提出的质数是互相保密的，这个质数被认为是私钥。</li><li>双方使用自己的私钥、加密生成器以及种子数派生出一个公钥。</li><li>交换派生出的公钥。</li><li>接收方使用自己的私钥、种子数以及接收到的对方公钥计算出共享密钥。尽管双方的共享密钥是使用对方的公钥以及自己的私钥计算的，但因为使用的算法，能保证双方计算出的共享密钥相同。</li><li>这个共享密钥将用于加密后续通信。例如，ssh 连接过程中，使用 host key 对共享密钥进行签名，然后验证指纹来完成主机认证的过程。</li></ul><p>由此可见，在计算共享密钥过程中，双方使用的公钥、私钥是相反的。但因为 DH 算法的原因，它能保证双方生成的共享密钥是一致的。而且因为双方在整个过程中是完全平等的，没有任何一方能掌控协商的命脉，再者共享密钥没有在网络上进行传输，使得使用共享密钥做对称加密的数据传输是安全的。</p>`,67)]))}const r=i(l,[["render",e]]),c=JSON.parse('{"path":"/openssl/docs/commands.html","title":"OpenSSL 命令","lang":"zh-CN","frontmatter":{"description":"OpenSSL 命令 genrsa genrsa 用于生成 RSA 私钥，不会生成公钥，因为公钥提取自私钥，如果要查看公钥或者生成公钥可以使用 openssl rsa 命令。 openssl genrsa [-out filename] [-passout arg] [-des] [-des3] [-idea] [numbits]： -out file...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"OpenSSL 命令\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-13T01:18:18.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://ppg007.github.io/openssl/docs/commands.html"}],["meta",{"property":"og:site_name","content":"PPG007 的文档"}],["meta",{"property":"og:title","content":"OpenSSL 命令"}],["meta",{"property":"og:description","content":"OpenSSL 命令 genrsa genrsa 用于生成 RSA 私钥，不会生成公钥，因为公钥提取自私钥，如果要查看公钥或者生成公钥可以使用 openssl rsa 命令。 openssl genrsa [-out filename] [-passout arg] [-des] [-des3] [-idea] [numbits]： -out file..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-13T01:18:18.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-13T01:18:18.000Z"}]]},"git":{"createdTime":1650114305000,"updatedTime":1747099098000,"contributors":[{"name":"PPG007","username":"PPG007","email":"1658272229@qq.com","commits":6,"url":"https://github.com/PPG007"},{"name":"Koston Zhuang","username":"","email":"koston.zhuang@maiscrm.com","commits":1}]},"readingTime":{"minutes":11.19,"words":3358},"filePathRelative":"openssl/docs/commands.md","excerpt":"\\n<h2>genrsa</h2>\\n<p>genrsa 用于生成 RSA 私钥，不会生成公钥，因为公钥提取自私钥，如果要查看公钥或者生成公钥可以使用 <code>openssl rsa</code> 命令。</p>","autoDesc":true}');export{r as comp,c as data};
