import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,d as n,o as e}from"./app-UKhqlS50.js";const p={};function l(h,s){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="安装-kubernetes" tabindex="-1"><a class="header-anchor" href="#安装-kubernetes"><span>安装 Kubernetes</span></a></h1><h2 id="安装-docker" tabindex="-1"><a class="header-anchor" href="#安装-docker"><span>安装 Docker</span></a></h2><p>卸载旧版本：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">remove</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker-engine</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker.io</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">containerd</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">runc</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">purge</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker-ce</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker-ce-cli</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">containerd.io</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rm</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-rf</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/var/lib/docker</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rm</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-rf</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/var/lib/containerd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装依赖以及docker：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">install</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">ca-certificates</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">curl</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">gnupg</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">lsb-release</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">curl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-fsSL</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://download.docker.com/linux/ubuntu/gpg</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">gpg</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--dearmor</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-o</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/usr/share/keyrings/docker-archive-keyring.gpg</span></span>
<span class="line"><span style="--shiki-dark:#56B6C2;--shiki-light:#795E26;">echo</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;deb</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">[arch=$(</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">dpkg</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--print-architecture</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">)</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">signed-by=/usr/share/keyrings/docker-archive-keyring.gpg]</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://download.docker.com/linux/ubuntu</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">$(</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">lsb_release</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-cs</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">)</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">stable&quot;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">tee</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/apt/sources.list.d/docker.list</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&gt;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/dev/null</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">update</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">install</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker-ce</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker-ce-cli</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">containerd.io</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了适配 k8s：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">mkdir</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/docker</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">cat</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&lt;&lt;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">tee</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/docker/daemon.json</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;exec-opts&quot;:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">[&quot;native.cgroupdriver=systemd&quot;],</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;log-driver&quot;:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;json-file&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;log-opts&quot;:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;max-size&quot;:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;100m&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;storage-driver&quot;:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;overlay2&quot;</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">systemctl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">enable</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">systemctl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">daemon-reload</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">systemctl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">restart</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装-kubeadm、kubelet-和-kubectl" tabindex="-1"><a class="header-anchor" href="#安装-kubeadm、kubelet-和-kubectl"><span>安装 kubeadm、kubelet 和 kubectl</span></a></h2><p>禁用交换分区：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">swapoff</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-a</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sed</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-ri</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;s/.*swap.*/#&amp;/&#39;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/fstab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>允许 iptables 检查桥接流量：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">cat</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&lt;&lt;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">tee</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/modules-load.d/k8s.conf</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">br_netfilter</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">cat</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&lt;&lt;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">tee</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/sysctl.d/k8s.conf</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">net.bridge.bridge-nf-call-ip6tables</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">=</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">1</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">net.bridge.bridge-nf-call-iptables</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">=</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">1</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">EOF</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">sysctl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--system</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在每台机器上安装以下的软件包：</p><ul><li>kubeadm：用来初始化集群的指令。</li><li>kubelet：在集群中的每个节点上用来启动 Pod 和容器等。</li><li>kubectl：用来与集群通信的命令行工具。</li></ul><p>更新 apt 包索引并安装使用 Kubernetes apt 仓库所需要的包：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">update</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">install</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-y</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-transport-https</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">ca-certificates</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">curl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>下载 Google Cloud 公开签名秘钥：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">curl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-fsSLo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/usr/share/keyrings/kubernetes-archive-keyring.gpg</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://packages.cloud.google.com/apt/doc/apt-key.gpg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>添加 Kubernetes apt 仓库：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#56B6C2;--shiki-light:#795E26;">echo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;deb</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">[signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg]</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://apt.kubernetes.io/</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-xenial</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">main&quot;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">tee</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/apt/sources.list.d/kubernetes.list</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>更新 apt 包索引，安装 kubelet、kubeadm 和 kubectl，并锁定其版本：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">update</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">install</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-y</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubelet</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubeadm</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubectl</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sudo</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apt-mark</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">hold</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubelet</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubeadm</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubectl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="初始化主节点" tabindex="-1"><a class="header-anchor" href="#初始化主节点"><span>初始化主节点</span></a></h2><p>初始化主节点</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubeadm</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">init</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">--apiserver-advertise-address=192.168.2.118</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">--control-plane-endpoint=ubuntu1</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">--service-cidr=10.96.0.0/16</span><span class="space"> </span><span style="--shiki-dark:#56B6C2;--shiki-light:#EE0000;">\\</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">--pod-network-cidr=192.167.0.0/16</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装网络插件，为了 Pod 之间能够通信，这里使用 calico：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">curl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://projectcalico.docs.tigera.io/manifests/calico.yaml</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-O</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将此 yaml 配置文件中的 192.168.0.0/16 修改为上面 --pod-network-cidr 的值并取消注释：</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">CALICO_IPV4POOL_CIDR</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">value</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">&#39;192.167.0.0/16&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>安装网络组件：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apply</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-f</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">calico.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="添加其他节点" tabindex="-1"><a class="header-anchor" href="#添加其他节点"><span>添加其他节点</span></a></h2><p>添加的时候需要用到 <code>kubeadm init</code> 初始化时最后生成的 token，如果忘记了，可以使用 <code>kubeadm token list</code> 命令获取 token 列表，默认 token 有效期为 24 小时，如果已经过期，可以使用 <code>kubeadm token create</code> 命令重新生成，还可以加上 <code>--print-join-command</code> 直接把加入命令打印出来。</p><p>在其他节点执行命令：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubeadm</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">join</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">192.168.2.118:6443</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--token</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">qz28oa.pi6w2ewiwhnixv9m</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">--discovery-token-ca-cert-hash</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">sha256:e81804ebb8dfc4311d4663927f6f5918cff1f5c87a0566234a86bd1f126b6db0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果证书哈希也忘记了，可以使用下面的命令生成：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">x509</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pubkey</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-in</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/kubernetes/pki/ca.crt</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">rsa</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-pubin</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-outform</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">der</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">2&gt;</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/dev/null</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">openssl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dgst</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-sha256</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-hex</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span class="space"> </span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sed</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;s/^.*</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">//&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>现在在主节点使用 <code>kubectl get nodes</code> 命令就可以看到加入的节点，刚开始状态是 NotReady，可以使用 <code>kubectl get pods -A -w</code> 命令查看其他节点的准备情况，稍等一会就 Ready 了。</p><h2 id="部署-dashbord" tabindex="-1"><a class="header-anchor" href="#部署-dashbord"><span>部署 <a href="https://github.com/kubernetes/dashboard" target="_blank" rel="noopener noreferrer">dashbord</a></span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apply</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-f</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">https://raw.githubusercontent.com/kubernetes/dashboard/v2.5.1/aio/deploy/recommended.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>设置访问端口：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">edit</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">svc</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-dashboard</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-dashboard</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>将其中的 type: ClusterIP 改为 type: NodePort。</p><p>执行下面的命令获取暴露的端口号：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">svc</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-A</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">|</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">grep</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-dashboard</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>创建 access.yaml：</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">apiVersion</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">v1</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">kind</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">ServiceAccount</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">metadata</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">admin-user</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">namespace</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">kubernetes-dashboard</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">---</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">apiVersion</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">rbac.authorization.k8s.io/v1</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">kind</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">ClusterRoleBinding</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">metadata</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">admin-user</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">roleRef</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">apiGroup</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">rbac.authorization.k8s.io</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">kind</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">ClusterRole</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">cluster-admin</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">subjects</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">kind</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">ServiceAccount</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">admin-user</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">namespace</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">kubernetes-dashboard</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行下面的命令生成 token：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">apply</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-f</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">access.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>获取访问令牌：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-dashboard</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">secret</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">$(</span><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">kubectl</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-n</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">kubernetes-dashboard</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">sa/admin-user</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-o</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">jsonpath=&quot;{.secrets[0].name}&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-o</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">go-template=&quot;{{.data.token | base64decode}}&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,52)]))}const c=a(p,[["render",l]]),d=JSON.parse('{"path":"/kubernetes/docs/install.html","title":"安装 Kubernetes","lang":"zh-CN","frontmatter":{"description":"安装 Kubernetes 安装 Docker 卸载旧版本： 安装依赖以及docker： 为了适配 k8s： 安装 kubeadm、kubelet 和 kubectl 禁用交换分区： 允许 iptables 检查桥接流量： 在每台机器上安装以下的软件包： kubeadm：用来初始化集群的指令。 kubelet：在集群中的每个节点上用来启动 Pod 和容...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"安装 Kubernetes\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-13T01:18:18.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://ppg007.github.io/kubernetes/docs/install.html"}],["meta",{"property":"og:site_name","content":"PPG007 的文档"}],["meta",{"property":"og:title","content":"安装 Kubernetes"}],["meta",{"property":"og:description","content":"安装 Kubernetes 安装 Docker 卸载旧版本： 安装依赖以及docker： 为了适配 k8s： 安装 kubeadm、kubelet 和 kubectl 禁用交换分区： 允许 iptables 检查桥接流量： 在每台机器上安装以下的软件包： kubeadm：用来初始化集群的指令。 kubelet：在集群中的每个节点上用来启动 Pod 和容..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-13T01:18:18.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-13T01:18:18.000Z"}]]},"git":{"createdTime":1648826140000,"updatedTime":1747099098000,"contributors":[{"name":"PPG007","username":"PPG007","email":"1658272229@qq.com","commits":1,"url":"https://github.com/PPG007"},{"name":"Koston Zhuang","username":"","email":"koston.zhuang@maiscrm.com","commits":1}]},"readingTime":{"minutes":2.79,"words":838},"filePathRelative":"kubernetes/docs/install.md","excerpt":"\\n<h2>安装 Docker</h2>\\n<p>卸载旧版本：</p>","autoDesc":true}');export{c as comp,d as data};
