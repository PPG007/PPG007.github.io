import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as e,o as n}from"./app-UKhqlS50.js";const t={};function l(h,s){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="redis持久化" tabindex="-1"><a class="header-anchor" href="#redis持久化"><span>Redis持久化</span></a></h1><h2 id="rdb-持久化" tabindex="-1"><a class="header-anchor" href="#rdb-持久化"><span>RDB 持久化</span></a></h2><h3 id="进行持久化" tabindex="-1"><a class="header-anchor" href="#进行持久化"><span>进行持久化</span></a></h3><p>文件：<code>dump.rdb</code>。</p><p>RDB 触发条件：</p><ul><li>满足 save规则。</li><li>执行 flushall。</li><li>退出 redis。</li></ul><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">每经过六秒或六条更改就会触发RDB</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">save</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">6</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">6</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>手动保存</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">该命令会阻塞当前Redis服务器，执行save命令期间，Redis不能处理其他命令，直到RDB过程完成为止。</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">save</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">执行该命令时，Redis会在后台异步进行快照操作，快照同时还可以响应客户端请求。</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">具体操作是Redis进程执行fork操作创建子进程，RDB持久化过程由子进程负责，完成后自动结束。</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">阻塞只发生在fork阶段，一般时间很短。</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">bgsave</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="从文件中恢复数据" tabindex="-1"><a class="header-anchor" href="#从文件中恢复数据"><span>从文件中恢复数据</span></a></h3><p>将数据文件放在 redis 启动目录即可。</p><p>获取启动目录：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">150.158.153.216:6379</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&gt;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">config</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">get</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">dir</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">1</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;dir&quot;</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">2</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">)</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;/etc/cron.d&quot;</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#启动目录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="aof-持久化" tabindex="-1"><a class="header-anchor" href="#aof-持久化"><span>AOF 持久化</span></a></h2><p>以日志形式记录所有写的操作，只许追加文件不可改写文件，redis 重启时会读取 AOF 并依次执行所有操作。</p><h3 id="开启-aof" tabindex="-1"><a class="header-anchor" href="#开启-aof"><span>开启 AOF</span></a></h3><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">appendonly</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">yes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,17)]))}const d=i(t,[["render",l]]),k=JSON.parse('{"path":"/redis/docs/persistent.html","title":"Redis持久化","lang":"zh-CN","frontmatter":{"description":"Redis持久化 RDB 持久化 进行持久化 文件：dump.rdb。 RDB 触发条件： 满足 save规则。 执行 flushall。 退出 redis。 手动保存 从文件中恢复数据 将数据文件放在 redis 启动目录即可。 获取启动目录： AOF 持久化 以日志形式记录所有写的操作，只许追加文件不可改写文件，redis 重启时会读取 AOF 并...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Redis持久化\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2021-12-28T13:51:24.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://ppg007.github.io/redis/docs/persistent.html"}],["meta",{"property":"og:site_name","content":"PPG007 的文档"}],["meta",{"property":"og:title","content":"Redis持久化"}],["meta",{"property":"og:description","content":"Redis持久化 RDB 持久化 进行持久化 文件：dump.rdb。 RDB 触发条件： 满足 save规则。 执行 flushall。 退出 redis。 手动保存 从文件中恢复数据 将数据文件放在 redis 启动目录即可。 获取启动目录： AOF 持久化 以日志形式记录所有写的操作，只许追加文件不可改写文件，redis 重启时会读取 AOF 并..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2021-12-28T13:51:24.000Z"}],["meta",{"property":"article:modified_time","content":"2021-12-28T13:51:24.000Z"}]]},"git":{"createdTime":1640699484000,"updatedTime":1640699484000,"contributors":[{"name":"PPG007","username":"PPG007","email":"1658272229@com请求","commits":1,"url":"https://github.com/PPG007"}]},"readingTime":{"minutes":0.91,"words":274},"filePathRelative":"redis/docs/persistent.md","excerpt":"\\n<h2>RDB 持久化</h2>\\n<h3>进行持久化</h3>","autoDesc":true}');export{d as comp,k as data};
