import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,d as n,o as i}from"./app-UKhqlS50.js";const l={};function e(c,s){return i(),p("div",null,s[0]||(s[0]=[n(`<h1 id="docker" tabindex="-1"><a class="header-anchor" href="#docker"><span>Docker</span></a></h1><p><a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer">Docker文档</a></p><p><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">DockerHub仓库</a></p><p><a href="https://vuepress.mirror.docker-practice.com/" target="_blank" rel="noopener noreferrer">Docker 从入门到实践</a></p><p><a href="https://github.com/phusion/baseimage-docker/blob/master/README_ZH_cn_.md" target="_blank" rel="noopener noreferrer">Ubuntu 基础镜像</a></p><p>基于 Ubuntu 基础镜像构建 MySQL 的 Dockerfile：</p><div class="language-docker line-numbers-mode" data-highlighter="shiki" data-ext="docker" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-docker"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">FROM</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">phusion/baseimage:master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">HOME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/root</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">MYSQL_USERNAME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">root</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">MYSQL_PASSWORD</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">123456</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">MYSQL_DB_NAME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">my_db</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">CMD</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;/sbin/my_init&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">]</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">update</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">mysql-server</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">EXPOSE</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">3306</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">在基础镜像</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">/etc/my_init.d/</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">中的脚本会在容器启动时执行</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">COPY</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">./my_init.d/start_mysql.sh</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/my_init.d/start_mysql.sh</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">clean</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">rm</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-rf</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/lib/apt/lists/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/tmp/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/tmp/*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动脚本：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">sed</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-i</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;s/127.0.0.1/0.0.0.0/&#39;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">/etc/mysql/mysql.conf.d/mysqld.cnf</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">service</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">mysql</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">start</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">mysql</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-uroot</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-e</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;CREATE</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">USER</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;\${</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">MYSQL_USERNAME</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">}&#39;@&#39;%&#39;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">IDENTIFIED</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">BY</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;\${</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">MYSQL_PASSWORD</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">}&#39;;&quot;</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">mysql</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-uroot</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-e</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;GRANT</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">ALL</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">PRIVILEGES</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">ON</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">*.*</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">TO</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;\${</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">MYSQL_USERNAME</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">}&#39;@&#39;%&#39;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">WITH</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">GRANT</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">OPTION;&quot;</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">mysql</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-uroot</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">-e</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;CREATE</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">DATABASE</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">\${</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">MYSQL_DB_NAME</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">};&quot;</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">service</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">mysql</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">restart</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">/bin/bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基于 Ubuntu 基础镜像构建 PHP 的 Dockerfile：</p><div class="language-docker line-numbers-mode" data-highlighter="shiki" data-ext="docker" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-docker"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">FROM</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">phusion/baseimage:master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">HOME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/root</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">CMD</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;/sbin/my_init&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">]</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-add-repository</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">ppa:ondrej/php</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">update</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">php7.0</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">php7.0-mysql</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">php7.0-fpm</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">php7.0-gd</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">COPY</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">my_init.d/start_php.sh</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/my_init.d/start_php.sh</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">EXPOSE</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">9000</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">clean</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">rm</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-rf</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/lib/apt/lists/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/tmp/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/tmp/*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动脚本：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">service</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">php7.0-fpm</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>基于 Ubuntu 基础镜像构建 Nginx 的 Dockerfile：</p><div class="language-docker line-numbers-mode" data-highlighter="shiki" data-ext="docker" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-docker"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">FROM</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">phusion/baseimage:master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">ENV</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">HOME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/root</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">CMD</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;/sbin/my_init&quot;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">]</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">update</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">install</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-y</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">nginx</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">COPY</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">my_init.d/start_nginx.sh</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/my_init.d/start_nginx.sh</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">EXPOSE</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">80</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#0000FF;">RUN</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">apt-get</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">clean</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">rm</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-rf</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/lib/apt/lists/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/tmp/*</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/tmp/*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动脚本：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-sh"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#!/bin/sh</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#795E26;">service</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">nginx</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">start</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 Ubuntu 基础镜像构建 Nginx，PHP，MySQL 镜像，并使用 Docker-Compose 构建一个 WordPress 站点的 <code>docker-compose.yml</code>：</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">version</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">&#39;3&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">services</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">mysql</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./MySQL</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">Dockerfile</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">environment</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">MYSQL_DB_NAME</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">wordpress</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">MYSQL_USERNAME</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">root</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">MYSQL_PASSWORD</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">123456</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">&#39;3306:3306&#39;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./MySQL/conf/my.cnf:/etc/mysql/my.cnf:ro</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">挂载配置文件，允许简单密码。</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">php</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./PHP</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">Dockerfile</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">&#39;9000:9000&#39;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">~/playground/wordpress:/var/www/html</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">挂载</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">WordPress</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">静态文件</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./PHP/conf/www.conf:/etc/php/7.0/fpm/pool.d/www.conf:ro</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">挂载</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">php-fpm</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">配置文件。</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">nginx</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./Nginx</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">Dockerfile</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">&#39;80:80&#39;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">./Nginx/conf/nginx.conf:/etc/nginx/nginx.conf:ro</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">挂载</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">Nginx</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">配置文件。</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">volumes_from</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">php</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">#</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">共享</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">PHP</span><span class="space"> </span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#008000;--shiki-light-font-style:inherit;">的数据卷。</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#800000;">depends_on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">:</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#0000FF;">php</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MySQL 配置文件：</p><div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-toml"><span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[</span><span style="--shiki-dark:#61AFEF;--shiki-light:#000000;">mysqld</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">]</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">default_authentication_plugin</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">m</span><span style="--shiki-dark:#FFFFFF;--shiki-light:#CD3131;">ysql_native_password</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Nginx 配置文件：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-nginx"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">user</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">root;</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">worker_processes</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">auto;</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">error_log</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/log/nginx/error.log;</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">pid</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/run/nginx.pid;</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">include</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/usr/share/nginx/modules/*.conf;</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">events</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">worker_connections</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">1024</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">http</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">log_format</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">main</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">remote_addr</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">-</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">remote_user</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">[$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">time_local</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">]</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">request</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">status</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">body_bytes_sent</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">http_referer</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&#39;&quot;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">http_user_agent</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;</span><span class="space"> </span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">http_x_forwarded_for</span><span style="--shiki-dark:#98C379;--shiki-light:#A31515;">&quot;&#39;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">access_log</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/log/nginx/access.log</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">main</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">sendfile</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">tcp_nopush</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">tcp_nodelay</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">keepalive_timeout</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">65</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">types_hash_max_size</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">4096</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">include</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/nginx/mime.types;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">default_type</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">application/octet-stream;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">include</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/nginx/conf.d/*.conf;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">server</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">listen</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#098658;">80</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">listen</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">[::]:80;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">server_name</span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">_;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">root</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="tab">	</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/var/www/html;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">index</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">index.php;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">include</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/etc/nginx/default.d/*.conf;</span></span>
<span class="line"><span class="tab">	</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">location</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">~</span><span class="space"> </span><span style="--shiki-dark:#E06C75;--shiki-light:#811F3F;">.php$</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">fastcgi_index</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">index.php;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">fastcgi_pass</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">php:9000;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">fastcgi_param</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">SCRIPT_FILENAME</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">document_root</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fastcgi_script_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">fastcgi_param</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">PATH_INFO</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">$</span><span style="--shiki-dark:#E06C75;--shiki-light:#001080;">fastcgi_path_info</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">fastcgi_intercept_errors</span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">include</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">fastcgi_params;</span></span>
<span class="line"><span class="tab">	</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">error_log</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">/usr/error_www.abc.com.log</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#D19A66;--shiki-light:#0000FF;">error</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PHP-FPM 配置文件，只修改 listen 属性值即可，要和 Nginx 的与 PHP 连接的配置相同：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-dark:#abb2bf;--shiki-light:#000000;--shiki-dark-bg:#282c34;--shiki-light-bg:#FFFFFF;"><pre class="shiki shiki-themes one-dark-pro light-plus vp-code"><code class="language-nginx"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#0000FF;">listen</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">=</span><span class="space"> </span><span style="--shiki-dark:#ABB2BF;--shiki-light:#000000;">9000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,25)]))}const t=a(l,[["render",e]]),r=JSON.parse('{"path":"/docker/","title":"Docker","lang":"zh-CN","frontmatter":{"description":"Docker Docker文档 DockerHub仓库 Docker 从入门到实践 Ubuntu 基础镜像 基于 Ubuntu 基础镜像构建 MySQL 的 Dockerfile： 启动脚本： 基于 Ubuntu 基础镜像构建 PHP 的 Dockerfile： 启动脚本： 基于 Ubuntu 基础镜像构建 Nginx 的 Dockerfile： 启动...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-13T05:52:32.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://ppg007.github.io/docker/"}],["meta",{"property":"og:site_name","content":"PPG007 的文档"}],["meta",{"property":"og:title","content":"Docker"}],["meta",{"property":"og:description","content":"Docker Docker文档 DockerHub仓库 Docker 从入门到实践 Ubuntu 基础镜像 基于 Ubuntu 基础镜像构建 MySQL 的 Dockerfile： 启动脚本： 基于 Ubuntu 基础镜像构建 PHP 的 Dockerfile： 启动脚本： 基于 Ubuntu 基础镜像构建 Nginx 的 Dockerfile： 启动..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-13T05:52:32.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-13T05:52:32.000Z"}]]},"git":{"createdTime":1640313645000,"updatedTime":1747115552000,"contributors":[{"name":"Koston Zhuang","username":"","email":"koston.zhuang@maiscrm.com","commits":5},{"name":"PPG007","username":"PPG007","email":"1658272229@com请求","commits":1,"url":"https://github.com/PPG007"}]},"readingTime":{"minutes":1.78,"words":533},"filePathRelative":"docker/README.md","excerpt":"\\n<p><a href=\\"https://docs.docker.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Docker文档</a></p>","autoDesc":true}');export{t as comp,r as data};
